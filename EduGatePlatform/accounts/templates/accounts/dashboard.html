{% extends "base.html" %}

{% block content %}
<h1 class="mb-3">Dashboard</h1>

{% if profile %}
  <div class="mb-4">
    <h5>Hello, {{ profile.full_name }} ğŸ‘‹</h5>
    <p class="text-muted">
      Role: {{ profile.get_role_display }} | National ID: {{ profile.national_id }}
    </p>
  </div>
{% endif %}

{% if is_admin %}
<div class="card mb-4">
  <div class="card-header bg-primary text-white">
    <h5 class="mb-0">Administrative Tools</h5>
  </div>
  <div class="card-body">

    <a href="{% url 'accounts:register' %}" class="btn btn-outline-primary mb-2 w-100">
      â• Add User (Teacher / Student / Parent)
    </a>

    <a href="{% url 'main:create_class' %}" class="btn btn-outline-secondary mb-2 w-100">
      ğŸ« Create School Class
    </a>

    <a href="{% url 'courses:assign_subject' %}" class="btn btn-outline-warning mb-2 w-100">
      ğŸ“˜ Assign Subject & Teacher to Class
    </a>

    <a href="{% url 'courses:enroll_student' %}" class="btn btn-outline-success mb-2 w-100">
      ğŸ‘¨â€ğŸ“ Enroll Student in Class
    </a>
    <a href="{% url 'courses:enroll_student' %}" class="btn btn-outline-success mb-2 w-100">
  ğŸ‘¨â€ğŸ“ Enroll Multiple Students in Class
</a>

<a href="{% url 'accounts:link_parent_children' %}" class="btn btn-outline-dark mb-2 w-100">
  ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Link Parent to Children
</a>


    <a href="{% url 'main:add_announcement' %}" class="btn btn-outline-info mb-2 w-100">
      ğŸ“¢ Add Announcement
    </a>

    <a href="/admin/" class="btn btn-dark w-100">
      ğŸ”§ Open Django Admin
    </a>
  </div>
</div>
{% endif %}


{% if role == "teacher" %}
  <h4>Your Classes & Subjects</h4>
  {% if teacher_classes %}
    <div class="row">
      {% for cs in teacher_classes %}
        <div class="col-md-4 mb-3">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">{{ cs.school_class.name }}</h5>
              <p class="card-text">{{ cs.subject.name }} ({{ cs.academic_year }})</p>
              <a href="{% url 'progress:teacher_class_subject' cs.id %}" class="btn btn-sm btn-primary">
                Manage lessons & homework
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No classes assigned yet.</p>
  {% endif %}

{% elif role == "student" %}
  <div class="mb-3">
    <a href="{% url 'accounts:student_subjects' %}" class="btn btn-primary me-2">My Subjects</a>
    <a href="{% url 'accounts:student_grades' %}" class="btn btn-outline-secondary">My Grades</a>
  </div>

{% elif role == "parent" %}
  <h4>Your Children</h4>
  {% if parent_children %}
    <ul class="list-group">
      {% for rel in parent_children %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ rel.student.profile.full_name }} ({{ rel.student.username }})
          <a href="{% url 'accounts:parent_child_grades' rel.student.id %}" class="btn btn-sm btn-outline-primary">
            View grades
          </a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No children linked to your account yet.</p>
  {% endif %}
{% else %}
  <p>Role not set. Please contact admin.</p>
{% endif %}
{% endblock %}
