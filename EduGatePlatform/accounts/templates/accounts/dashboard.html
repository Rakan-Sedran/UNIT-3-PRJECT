{% extends "base.html" %}
{% block content %}
<h1 class="mb-3"><i class="fas fa-chart-line me-2"></i> Dashboard</h1>

{% if profile %}
  <div class="card mb-4 bg-light shadow-sm">
    <div class="card-body">
      <h4 class="card-title">Hello, {{ profile.full_name }} ğŸ‘‹</h4>
      <p class="card-text text-muted">
        Your Role: <span class="badge bg-info fs-6">{{ profile.get_role_display }}</span> | National ID: **{{ profile.national_id }}**
      </p>
    </div>
  </div>
{% endif %}

{% if is_admin %}
    <div class="card mb-5 shadow-lg">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="fas fa-tools me-2"></i> Administrative Tools</h5>
      </div>
      <div class="card-body p-4">

        <h6 class="mb-3 text-primary"><i class="fas fa-users-cog me-2"></i> User & Relations Management</h6>
        <div class="row">
            <div class="col-md-6 mb-2">
                <a href="{% url 'accounts:manage_users' %}" class="btn btn-outline-primary w-100">
                    ğŸ‘¤ Manage Users
                </a>
            </div>
            <div class="col-md-6 mb-2">
                <a href="{% url 'accounts:manage_parent_links' %}" class="btn btn-outline-info w-100">
                    ğŸ”— Manage Parent Links
                </a>
            </div>
        </div>

        <hr class="my-4">

        <h6 class="mb-3 text-success"><i class="fas fa-book-reader me-2"></i> Courses & Classes Management</h6>
        <div class="row">
            <div class="col-md-6 mb-2">
                <a href="{% url 'main:schoolclass_list' %}" class="btn btn-outline-secondary w-100">
                    ğŸ« Manage School Classes
                </a>
            </div>
            <div class="col-md-6 mb-2">
                <a href="{% url 'courses:subject_list' %}" class="btn btn-outline-secondary w-100">
                    ğŸ“š Manage Subjects
                </a>
            </div>
            <div class="col-md-6 mb-2">
                <a href="{% url 'courses:classsubject_list' %}" class="btn btn-outline-warning w-100">
                    ğŸ“˜ Manage Subject to Class & Teacher
                </a>
            </div>
            <div class="col-md-6 mb-2">
                <a href="{% url 'courses:manage_enrollments' %}" class="btn btn-outline-warning w-100">
                    ğŸ‘¥ Manage Enrollments
                </a>
            </div>
        </div>


        <hr class="my-4">
        
        <h6 class="mb-3 text-danger"><i class="fas fa-bullhorn me-2"></i> Platform Management</h6>
          <a href="{% url 'main:announcement_list' %}" class="btn btn-outline-success w-100">
            ğŸ“¢ Manage School Announcements
          </a>

      </div>
    </div>

{% elif role == "teacher" %}
    <div class="mt-4">
        <h4 class="mb-3"><i class="fas fa-chalkboard-teacher me-2"></i> Your Assigned Classes</h4>
        <hr>
    </div>
    
    {% if teacher_classes %} 
      <div class="row">
        {% for cs in teacher_classes %}
          <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-lg border-primary"> 
              <div class="card-body p-4">
                <h4 class="card-title fw-bold text-primary mb-3">
                    <i class="fas fa-book me-2"></i> {{ cs.subject.name }} 
                </h4> 
                
                <p class="card-text">
                    <span class="fw-bold">Class:</span> <span class="badge bg-secondary fs-6">{{ cs.school_class.name }}</span>
                </p> 
                
                <p class="card-text"><small class="text-muted">Academic Year: {{ cs.academic_year }}</small></p>
                <hr>
                
                <a href="{% url 'progress:teacher_class_subject' cs.id %}" class="btn btn-primary w-100 mt-3">
                  Manage Content <i class="fas fa-arrow-right"></i>
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info shadow-sm"><i class="fas fa-info-circle me-2"></i> No subjects have been assigned to you yet.</div>
{% endif %}
{% elif role == "student" %}
    <h4 class="mt-4"><i class="fas fa-user-graduate me-2"></i> Student Panel</h4>
    <hr>
    <div class="row">
      <div class="col-md-6 mb-3">
        <a href="{% url 'accounts:student_subjects' %}" class="card-link-item">
          <div class="card text-center text-white bg-primary h-100 shadow-sm">
            <div class="card-body">
              <i class="fas fa-book-open fa-3x mb-2"></i>
              <h5 class="card-title mt-2">My Subjects</h5>
              <p class="card-text">View all your registered classes.</p>
            </div>
          </div>
        </a>
      </div>
      <div class="col-md-6 mb-3">
        <a href="{% url 'accounts:student_grades' %}" class="card-link-item">
          <div class="card text-center text-white bg-success h-100 shadow-sm">
            <div class="card-body">
              <i class="fas fa-award fa-3x mb-2"></i>
              <h5 class="card-title mt-2">My Grades</h5>
              <p class="card-text">Check your homework and quiz scores.</p>
            </div>
          </div>
        </a>
      </div>
    </div>

{% elif role == "parent" %}
    <h4 class="mt-4"><i class="fas fa-users-class me-2"></i> Your Children</h4>
    <hr>
    {% if parent_children %}
      <ul class="list-group shadow-sm">
        {% for rel in parent_children %}
          <li class="list-group-item d-flex justify-content-between align-items-center p-3">
            <span class="fw-bold"><i class="fas fa-child me-2 text-info"></i> {{ rel.student.profile.full_name }}</span>
            <span class="text-muted small">Username: {{ rel.student.username }}</span>
            <a href="{% url 'accounts:parent_child_grades' rel.student.id %}" class="btn btn-sm btn-info">
              View Grades <i class="fas fa-external-link-alt ms-1"></i>
            </a>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <div class="alert alert-warning"><i class="fas fa-exclamation-triangle me-2"></i> No children linked to your account yet.</div>
    {% endif %}

{% endif %} {% endblock %}